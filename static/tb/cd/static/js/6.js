(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{415:function(e,t,l){"use strict";var r=l(13),n=l(124),a=l(52),o=l(32),i=l(26),c=l(217),u=l(76),d=l(123)("splice"),s=Math.max,b=Math.min;r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var l,r,d,m,p,j,f=i(this),O=o(f.length),g=n(e,O),h=arguments.length;if(0===h?l=r=0:1===h?(l=0,r=O-g):(l=h-2,r=b(s(a(t),0),O-g)),O+l-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(d=c(f,r),m=0;m<r;m++)(p=g+m)in f&&u(d,m,f[p]);if(d.length=r,l<r){for(m=g;m<O-r;m++)j=m+l,(p=m+r)in f?f[j]=f[p]:delete f[j];for(m=O;m>O-r+l;m--)delete f[m-1]}else if(l>r)for(m=O-r;m>g;m--)j=m+l-1,(p=m+r-1)in f?f[j]=f[p]:delete f[j];for(m=0;m<l;m++)f[m+g]=arguments[m+2];return f.length=O-r+l,d}})},420:function(e,t,l){},433:function(e,t,l){"use strict";var r=l(13),n=l(81),a=l(25),o=l(220),i=[].join,c=n!=Object,u=o("join",",");r({target:"Array",proto:!0,forced:c||!u},{join:function(e){return i.call(a(this),void 0===e?",":e)}})},434:function(e,t,l){"use strict";l(420)},444:function(e,t,l){"use strict";l.r(t);l(73);var r=l(0),n=Object(r.gb)("data-v-66d86e1c");Object(r.H)("data-v-66d86e1c");var a=Object(r.n)("div",{class:"tip-demo"},[Object(r.m)("基础信息 "),Object(r.n)("span",null,"（带*号的是必填项）")],-1),o=Object(r.m)("身份证"),i=Object(r.m)("护照"),c=Object(r.n)("div",{class:"tip"},"请上传高清人脸图",-1),u={key:1,class:"el-icon-plus avatar-uploader-icon",style:{"font-size":"26px"}},d=Object(r.n)("div",{class:"tip-demo"},[Object(r.m)("关联工作人员信息 "),Object(r.n)("span",null,"（注：系统预警消息会发送到添加的工作人员处，添加后默认开通关爱在家小程序）")],-1),s={class:"add-person-main"},b=Object(r.m)(" 添加关联工作人员 "),m={class:"btn-li"},p=Object(r.m)("提交");Object(r.F)();var j=n(function(e,t,l,j,f,O){var g=Object(r.N)("el-input"),h=Object(r.N)("el-form-item"),v=Object(r.N)("el-radio"),k=Object(r.N)("el-option"),y=Object(r.N)("el-select"),F=Object(r.N)("el-upload"),w=Object(r.N)("el-switch"),V=Object(r.N)("el-button"),D=Object(r.N)("el-table-column"),P=Object(r.N)("el-table"),N=Object(r.N)("el-form"),_=Object(r.N)("el-card"),x=Object(r.N)("WorkingPersonnelAdd"),U=Object(r.N)("AddRelatives");return Object(r.E)(),Object(r.j)(r.b,null,[Object(r.n)(_,{class:"index-container"},{default:n(function(){return[Object(r.n)(N,{model:e.ruleForm,rules:e.rules,ref:"ruleFormBox","label-position":"left","label-width":"130px",class:"demo-ruleForm"},{default:n(function(){return[a,Object(r.n)(h,{label:"人员姓名：",prop:"name"},{default:n(function(){return[Object(r.n)(g,{modelValue:e.ruleForm.name,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.ruleForm.name=t}),modelModifiers:{trim:!0},disabled:e.isDetail,onInput:t[2]||(t[2]=function(t){return e.change(t)}),placeholder:"请输入重点人员姓名"},null,8,["modelValue","disabled"])]}),_:1}),Object(r.n)(h,{label:"联系电话：",prop:"phone"},{default:n(function(){return[Object(r.n)(g,{modelValue:e.ruleForm.phone,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.ruleForm.phone=t}),modelModifiers:{trim:!0},disabled:e.isDetail,onInput:t[4]||(t[4]=function(t){return e.change(t)}),placeholder:e.isDetail?"无联系电话":"请输入人员联系电话"},null,8,["modelValue","disabled","placeholder"])]}),_:1}),Object(r.n)(h,{label:"证件号码：",prop:"idCode"},{default:n(function(){return[Object(r.n)("div",null,[Object(r.n)(v,{modelValue:e.ruleForm.idType,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.ruleForm.idType=t}),disabled:e.isDetail,label:1},{default:n(function(){return[o]}),_:1},8,["modelValue","disabled"]),Object(r.n)(v,{modelValue:e.ruleForm.idType,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.ruleForm.idType=t}),disabled:e.isDetail,label:2},{default:n(function(){return[i]}),_:1},8,["modelValue","disabled"])]),Object(r.n)("div",null,[Object(r.n)(g,{modelValue:e.ruleForm.idCode,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.ruleForm.idCode=t}),modelModifiers:{trim:!0},disabled:e.isDetail,onInput:t[8]||(t[8]=function(t){return e.change(t)}),placeholder:"请输入证件号码"},null,8,["modelValue","disabled"])])]}),_:1}),Object(r.n)(h,{label:"现居住地址：",prop:"address"},{default:n(function(){return[Object(r.n)(g,{modelValue:e.ruleForm.address,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.ruleForm.address=t}),modelModifiers:{trim:!0},disabled:e.isDetail,onInput:t[10]||(t[10]=function(t){return e.change(t)}),placeholder:"请输入现居住地地址，详细到门牌号例如：XX镇XX小区XX栋XX单元XX号"},null,8,["modelValue","disabled"])]}),_:1}),Object(r.n)(h,{label:"重点人员类型：",prop:"checkList"},{default:n(function(){return[Object(r.n)(y,{modelValue:e.ruleForm.checkList,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.ruleForm.checkList=t}),multiple:"",disabled:e.isDetail,filterable:"",remote:"","reserve-keyword":"",placeholder:"搜索/选择重点人员类型可多选"},{default:n(function(){return[(Object(r.E)(!0),Object(r.j)(r.b,null,Object(r.L)(e.personTypeOptions,function(e){return Object(r.E)(),Object(r.j)(k,{key:e.id,label:e.tagName,value:e.tagName},null,8,["label","value"])}),128))]}),_:1},8,["modelValue","disabled"])]}),_:1}),Object(r.n)(h,{label:"人员照片：",prop:"imageUrlPath"},{default:n(function(){return[c,Object(r.n)(g,{modelValue:e.ruleForm.imageUrlPath,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.ruleForm.imageUrlPath=t}),modelModifiers:{trim:!0},disabled:e.isDetail,onInput:t[13]||(t[13]=function(t){return e.change(t)}),placeholder:"人员照片",style:{display:"none"}},null,8,["modelValue","disabled"]),Object(r.n)(F,{disabled:e.isDetail,class:"avatar-uploader",action:"/govern/fast/v1/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload},{default:n(function(){return[""!=e.ruleForm.imageUrlPath&&null!=e.ruleForm.imageUrlPath?(Object(r.E)(),Object(r.j)("img",{key:0,style:{width:"100px",height:"100px"},src:e.ruleForm.imageUrlPath,class:"avatar"},null,8,["src"])):(Object(r.E)(),Object(r.j)("i",u))]}),_:1},8,["disabled","on-success","before-upload"])]}),_:1}),Object(r.n)(h,{label:"是否常驻人员：",prop:"isLongLiving"},{default:n(function(){return[Object(r.n)(w,{modelValue:e.ruleForm.isLongLiving,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.ruleForm.isLongLiving=t}),disabled:e.isDetail,"active-text":"是","inactive-text":"否"},null,8,["modelValue","disabled"])]}),_:1}),Object(r.k)('          <el-form-item label="人员类型：" >'),Object(r.k)('              <el-checkbox-group v-model="checkList">'),Object(r.k)('                  <el-checkbox  v-for="item in personTypeOptions"'),Object(r.k)('                              :label="item.tageName"'),Object(r.k)("                              border"),Object(r.k)('                              :key="item.id">{{item.label}}</el-checkbox>'),Object(r.k)("              </el-checkbox-group>"),Object(r.k)("          </el-form-item>"),d,Object(r.n)("div",s,[Object(r.n)(V,{type:"primary",icon:"el-icon-plus",disabled:e.isDetail,circle:"",size:"mini",onClick:e.addWorker},null,8,["disabled","onClick"]),b]),Object(r.n)("div",null,[e.tableData?(Object(r.E)(),Object(r.j)(P,{key:0,data:e.tableData,style:{width:"100%","margin-top":"15px","margin-bottom":"20px"},border:""},{default:n(function(){return[Object(r.n)(D,{prop:"workerName",label:"姓名","min-width":"100"}),Object(r.n)(D,{prop:"workerPhone",label:"联系电话","min-width":"200"}),Object(r.n)(D,{prop:"positionName",label:"职位","min-width":"120"}),Object(r.n)(D,{prop:"isOpen",label:"是否开通采点小程序",align:"center","min-width":"120"},{default:n(function(e){return[Object(r.n)("span",null,Object(r.R)(e.row.isOpen?"是":"否"),1),Object(r.k)('                          <el-switch v-model="scope.row.isApplets" active-text="是"  inactive-text="否"></el-switch>')]}),_:1}),Object(r.n)(D,{label:"","min-width":"120",align:"center"},{default:n(function(t){return[Object(r.n)(V,{type:"danger",size:"mini",icon:"el-icon-delete",disabled:e.isDetail,onClick:function(l){return e.deleteWorker(t.row)},circle:""},null,8,["disabled","onClick"])]}),_:1})]}),_:1},8,["data"])):Object(r.k)("v-if",!0)]),Object(r.k)('          <div class="tip-demo">添加亲属信息</div>'),Object(r.k)('          <div class="add-person-main">'),Object(r.k)('              <el-button type="primary" icon="el-icon-plus" circle size="mini" @click="addRelatives"></el-button> 添加亲属信息'),Object(r.k)("          </div>"),Object(r.k)("          <div>"),Object(r.k)('              <el-table :data="tableData" style="width: 100%;margin-top: 15px" border>'),Object(r.k)('                  <el-table-column prop="name" label="姓名" min-width="100" ></el-table-column>'),Object(r.k)('                  <el-table-column prop="phone" label="联系电话" min-width="200"></el-table-column>'),Object(r.k)('                  <el-table-column prop="position" label="亲属关系" min-width="120"></el-table-column>'),Object(r.k)('                  <el-table-column  label="" min-width="120" align="center">'),Object(r.k)('                      <template #default="scope">'),Object(r.k)('                          <el-button type="danger" size="mini" icon="el-icon-delete" circle></el-button>'),Object(r.k)("                      </template>"),Object(r.k)("                  </el-table-column>"),Object(r.k)("              </el-table>"),Object(r.k)("          </div>")]}),_:1},8,["model","rules"]),Object(r.n)("div",m,[e.isDetail?Object(r.k)("v-if",!0):(Object(r.E)(),Object(r.j)(V,{key:0,type:"primary",onClick:e.comfirmForm},{default:n(function(){return[p]}),_:1},8,["onClick"])),Object(r.n)(V,{onClick:e.restForm},{default:n(function(){return[Object(r.m)(Object(r.R)(e.isDetail?"返回":"取消"),1)]}),_:1},8,["onClick"])])]}),_:1}),Object(r.n)(x,{ref:"addWorking",onSelectionPerson:e.selectionPersonLi},null,8,["onSelectionPerson"]),Object(r.n)(U,{ref:"addRelativesDialog"},null,512)],64)}),f=l(21),O=(l(75),l(412),l(216),l(415),l(433),l(74)),g=l(410),h=l(429),v=Object(r.gb)("data-v-1b459c58");Object(r.H)("data-v-1b459c58");var k={style:{"text-align":"center"}},y=Object(r.m)("提交"),F=Object(r.m)("取消");Object(r.F)();var w=v(function(e,t,l,n,a,o){var i=Object(r.N)("el-input"),c=Object(r.N)("el-form-item"),u=Object(r.N)("el-form"),d=Object(r.N)("el-button"),s=Object(r.N)("el-dialog");return Object(r.E)(),Object(r.j)(s,{title:"添加亲属信息",modelValue:e.dialogTableVisible,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.dialogTableVisible=t})},{default:v(function(){return[Object(r.n)(u,{model:e.ruleForm,rules:e.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:v(function(){return[Object(r.n)(c,{label:"人员姓名：",prop:"name"},{default:v(function(){return[Object(r.n)(i,{modelValue:e.ruleForm.name,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.ruleForm.name=t}),modelModifiers:{trim:!0},onInput:t[2]||(t[2]=function(e){return n.change(e)}),placeholder:"请输入重点人员姓名"},null,8,["modelValue"])]}),_:1}),Object(r.n)(c,{label:"联系电话：",prop:"tel"},{default:v(function(){return[Object(r.n)(i,{modelValue:e.ruleForm.tel,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.ruleForm.tel=t}),modelModifiers:{trim:!0},onInput:t[4]||(t[4]=function(e){return n.change(e)}),placeholder:"请输入人员联系电话"},null,8,["modelValue"])]}),_:1}),Object(r.n)(c,{label:"亲属关系：",prop:"relatives"},{default:v(function(){return[Object(r.n)(i,{modelValue:e.ruleForm.relatives,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.ruleForm.relatives=t}),modelModifiers:{trim:!0},onInput:t[6]||(t[6]=function(e){return n.change(e)}),placeholder:"请输入重点人员与亲属的关系"},null,8,["modelValue"])]}),_:1})]}),_:1},8,["model","rules"]),Object(r.n)("div",k,[Object(r.n)(d,{type:"primary",onClick:n.onSubmit},{default:v(function(){return[y]}),_:1},8,["onClick"]),Object(r.n)(d,{onClick:n.closeDialog},{default:v(function(){return[F]}),_:1},8,["onClick"])])]}),_:1},8,["modelValue"])}),V={name:"addRelatives",props:{type:String,reload:Function},setup:function(e){var t=this,l=Object(r.J)(null),n=Object(r.I)({dialogTableVisible:!1,ruleForm:{name:"",tel:"",relatives:""},rules:{name:[{required:!0,message:"请输入重点人员姓名",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],tel:[{required:!0,message:"请输入人员联系电话",trigger:"blur"},{validator:g.a.phoneValidata,trigger:"blur"}],relatives:[{required:!0,message:"请输入重点人员与亲属的关系",trigger:"blur"}]}});return Object(f.a)(Object(f.a)({},Object(r.U)(n)),{},{formRef:l,openDialog:function(e){n.dialogTableVisible=!0},closeDialog:function(){n.dialogTableVisible=!1,l.value.resetFields()},change:function(e){t.$forceUpdate()},onSubmit:function(){}})}};V.render=w,V.__scopeId="data-v-1b459c58";var D=V,P=l(33),N=l(19),_=Object(r.o)({name:"重点人员新增",components:{WorkingPersonnelAdd:h.a,AddRelatives:D},setup:function(){var e=Object(N.c)(),t=Object(N.d)(),l=(Object(r.J)([]),Object(r.J)(null)),n=Object(r.J)(null),a=Object(r.J)(null),o=Object(r.I)({idType:"1",axios2:O.a,isDetail:!1,ruleForm:{name:"",phone:"",idCode:"",address:"",personType:[],imageUrlPath:"",isLongLiving:!0,checkList:[],idType:1},tableData:[],personTypeOptions:[],rules:{name:[{required:!0,message:"请输入重点人员姓名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入人员联系电话",trigger:"blur"},{validator:g.a.phoneValidata,trigger:"blur"}],idCode:[{required:!0,message:"请输入证件号码",trigger:"blur"},{validator:g.a.idCardValidate,trigger:"blur"}],address:[{required:!0,message:"请输入居住地址",trigger:"blur"}],personType:[{type:"array",required:!0,message:"请选择重点人员类型",trigger:"change"}],imageUrlPath:[{required:!0,message:"请上传重点人员照片",trigger:"blur"}],checkList:[{type:"array",required:!0,message:"请选择重点人员类型",trigger:"change"}],isLongLiving:[{type:"boolean",required:!0,message:"请选择是否常驻人员",trigger:"change"}]}});Object(r.B)(function(){u(),e.query&&e.query.id&&i(e.query.id),e.query.txt&&"detail"==e.query.txt&&(o.isDetail=!0)});var i=function(e){O.a.get("/govern/keyPerson/getKeyPersonInfo/".concat(e)).then(function(e){200==e.code&&(o.ruleForm=e.data.keyPerson,o.ruleForm.checkList=o.ruleForm.tag.split(","),o.tableData=o.ruleForm.workers)})},c=function(){o.ruleForm={name:"",phone:"",idCode:"",address:"",personType:[],imageUrlPath:"",isLongLiving:!0,checkList:[],idType:"1"},l.value.resetFields(),t.go(-1)},u=function(){O.a.get("/govern/tag/getTags").then(function(e){200==e.code&&(o.personTypeOptions=e.data.tags)})};return Object(f.a)(Object(f.a)({},Object(r.U)(o)),{},{ruleFormBox:l,selectionPersonLi:function(e){for(var t=n.value.selectionPersonList,l=0;l<t.length;l++){var r={workerName:t[l].name,workerPhone:t[l].mobile,isOpen:t[l].ifGather,positionName:t[l].positionName,workPosition:t[l].workPosition};o.tableData.push(r)}if(o.tableData.length>1){var a={},i=o.tableData.reduce(function(e,t){return!a[t.workerPhone]&&(a[t.workerPhone]=e.push(t)),e},[]);o.tableData=i}n.value.closeDialog()},addWorking:n,addRelativesDialog:a,comfirmForm:function(){l.value.validate(function(e){if(e){var t=[];o.ruleForm.checkList.forEach(function(e){t.push(e)}),o.ruleForm.tag=t.join(",");var l=[];o.tableData.forEach(function(e,t){var r={workerName:e.workerName,workerPhone:e.workerPhone,isOpen:e.isOpen,workPosition:e.workPosition};l.push(r)}),o.ruleForm.workers=l;var r=Object.assign(Object(f.a)({},o.ruleForm));r.checkList=null;var n=o.ruleForm.id?"/govern/keyPerson/updateKeyPerson":"/govern/keyPerson/addKeyPerson";O.a.post(n,r).then(function(e){200==e.code&&(c(),Object(P.a)({type:"success",message:e.message}))})}})},change:function(e){},addRelatives:function(){a.value.openDialog()},handleAvatarSuccess:function(e,t){e.data&&e.data.url?o.ruleForm.imageUrlPath=e.data.url:Object(P.a)({type:"error",message:e.message})},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png",l=e.size/1024/1024<10;return t||Object(P.a)({type:"error",message:"请上传正确的图片！"}),l||Object(P.a)({type:"error",message:"上传头像图片大小不能超过 10MB!"}),t&&l},addWorker:function(){n.value.openDialog(null,!0)},deleteWorker:function(e){o.tableData.forEach(function(t,l){e.workerPhone==t.workerPhone&&o.tableData.splice(l,1)})},restForm:c,getPersonDetail:i})}});l(434);_.render=j,_.__scopeId="data-v-66d86e1c";t.default=_}}]);